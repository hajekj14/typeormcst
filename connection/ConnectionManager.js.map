{"version":3,"sources":["../../src/connection/ConnectionManager.ts"],"names":[],"mappings":"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","file":"ConnectionManager.js","sourcesContent":["import {Connection} from \"./Connection\";\r\nimport {ConnectionNotFoundError} from \"./error/ConnectionNotFoundError\";\r\nimport {MysqlDriver} from \"../driver/mysql/MysqlDriver\";\r\nimport {ConnectionOptions} from \"./ConnectionOptions\";\r\nimport {DriverOptions} from \"../driver/DriverOptions\";\r\nimport {Driver} from \"../driver/Driver\";\r\nimport {MissingDriverError} from \"./error/MissingDriverError\";\r\nimport {PostgresDriver} from \"../driver/postgres/PostgresDriver\";\r\nimport {AlreadyHasActiveConnectionError} from \"./error/AlreadyHasActiveConnectionError\";\r\nimport {Logger} from \"../logger/Logger\";\r\nimport {SqliteDriver} from \"../driver/sqlite/SqliteDriver\";\r\nimport {OracleDriver} from \"../driver/oracle/OracleDriver\";\r\nimport {SqlServerDriver} from \"../driver/sqlserver/SqlServerDriver\";\r\nimport {OrmUtils} from \"../util/OrmUtils\";\r\nimport {CannotDetermineConnectionOptionsError} from \"./error/CannotDetermineConnectionOptionsError\";\r\nimport {PlatformTools} from \"../platform/PlatformTools\";\r\nimport {WebsqlDriver} from \"../driver/websql/WebsqlDriver\";\r\nimport {MongoDriver} from \"../driver/mongodb/MongoDriver\";\r\n\r\n/**\r\n * ConnectionManager is used to store and manage all these different connections.\r\n * It also provides useful factory methods to simplify connection creation.\r\n */\r\nexport class ConnectionManager {\r\n\r\n    // -------------------------------------------------------------------------\r\n    // Protected Properties\r\n    // -------------------------------------------------------------------------\r\n\r\n    /**\r\n     * List of connections registered in this connection manager.\r\n     */\r\n    protected connections: Connection[] = [];\r\n\r\n    // -------------------------------------------------------------------------\r\n    // Public Methods\r\n    // -------------------------------------------------------------------------\r\n\r\n    /**\r\n     * Checks if connection with the given name exist in the manager.\r\n     */\r\n    has(name: string): boolean {\r\n        return !!this.connections.find(connection => connection.name === name);\r\n    }\r\n\r\n    /**\r\n     * Gets registered connection with the given name.\r\n     * If connection name is not given then it will get a default connection.\r\n     * Throws exception if connection with the given name was not found.\r\n     */\r\n    get(name: string = \"default\"): Connection {\r\n        const connection = this.connections.find(connection => connection.name === name);\r\n        if (!connection)\r\n            throw new ConnectionNotFoundError(name);\r\n\r\n        return connection;\r\n    }\r\n\r\n    /**\r\n     * Creates a new connection based on the given connection options and registers it in the manager.\r\n     * You need to manually call #connect method to establish connection.\r\n     * Note that dropSchemaOnConnection and autoSchemaSync options of a ConnectionOptions will not work there - use\r\n     * createAndConnect method to use them.\r\n     */\r\n    create(options: ConnectionOptions): Connection {\r\n\r\n        const logger = new Logger(options.logging || {});\r\n        const driver = this.createDriver(options.driver, logger);\r\n        const connection = this.createConnection(options.name || \"default\", driver, logger);\r\n\r\n        // import entity schemas\r\n        if (options.entitySchemas) {\r\n            const [directories, classes] = this.splitStringsAndClasses(options.entitySchemas);\r\n            connection\r\n                .importEntitySchemas(classes)\r\n                .importEntitySchemaFromDirectories(directories);\r\n        }\r\n\r\n        // import entities\r\n        if (options.entities) {\r\n            const [directories, classes] = this.splitStringsAndClasses(options.entities);\r\n            connection\r\n                .importEntities(classes)\r\n                .importEntitiesFromDirectories(directories);\r\n        }\r\n\r\n        // import subscriber\r\n        if (options.subscribers) {\r\n            const [directories, classes] = this.splitStringsAndClasses(options.subscribers);\r\n            connection\r\n                .importSubscribers(classes)\r\n                .importSubscribersFromDirectories(directories);\r\n        }\r\n\r\n        // import naming strategies\r\n        if (options.namingStrategies) {\r\n            const [directories, classes] = this.splitStringsAndClasses(options.namingStrategies);\r\n            connection\r\n                .importNamingStrategies(classes)\r\n                .importNamingStrategiesFromDirectories(directories);\r\n        }\r\n\r\n        // import migrations\r\n        if (options.migrations) {\r\n            const [directories, classes] = this.splitStringsAndClasses(options.migrations);\r\n            connection\r\n                .importMigrations(classes)\r\n                .importMigrationsFromDirectories(directories);\r\n        }\r\n\r\n        // set naming strategy to be used for this connection\r\n        if (options.usedNamingStrategy)\r\n            connection.useNamingStrategy(options.usedNamingStrategy as any);\r\n\r\n        return connection;\r\n    }\r\n\r\n    /**\r\n     * Creates a new connection and registers it in the manager.\r\n     *\r\n     * If connection options were not specified, then it will try to create connection automatically.\r\n     *\r\n     * First, it will try to find a \"default\" configuration from ormconfig.json.\r\n     * You can also specify a connection name to use from ormconfig.json,\r\n     * and you even can specify a path to custom ormconfig.json file.\r\n     *\r\n     * In the case if options were not specified, and ormconfig.json file also wasn't found,\r\n     * it will try to create connection from environment variables.\r\n     * There are several environment variables you can set:\r\n     *\r\n     * - TYPEORM_DRIVER_TYPE - driver type. Can be \"mysql\", \"postgres\", \"mariadb\", \"sqlite\", \"oracle\" or \"mssql\".\r\n     * - TYPEORM_URL - database connection url. Should be a string.\r\n     * - TYPEORM_HOST - database host. Should be a string.\r\n     * - TYPEORM_PORT - database access port. Should be a number.\r\n     * - TYPEORM_USERNAME - database username. Should be a string.\r\n     * - TYPEORM_PASSWORD - database user's password. Should be a string.\r\n     * - TYPEORM_SID - database's SID. Used only for oracle databases. Should be a string.\r\n     * - TYPEORM_STORAGE - database's storage url. Used only for sqlite databases. Should be a string.\r\n     * - TYPEORM_USE_POOL - indicates if connection pooling should be enabled. By default its enabled. Should be boolean-like value.\r\n     * - TYPEORM_DRIVER_EXTRA - extra options to be passed to the driver. Should be a serialized json string of options.\r\n     * - TYPEORM_AUTO_SCHEMA_SYNC - indicates if automatic schema synchronization will be performed on each application run. Should be boolean-like value.\r\n     * - TYPEORM_ENTITIES - list of directories containing entities to load. Should be string - directory names (can be patterns) split by a comma.\r\n     * - TYPEORM_SUBSCRIBERS - list of directories containing subscribers to load. Should be string - directory names (can be patterns) split by a comma.\r\n     * - TYPEORM_ENTITY_SCHEMAS - list of directories containing entity schemas to load. Should be string - directory names (can be patterns) split by a comma.\r\n     * - TYPEORM_NAMING_STRATEGIES - list of directories containing custom naming strategies to load. Should be string - directory names (can be patterns) split by a comma.\r\n     * - TYPEORM_LOGGING_QUERIES - indicates if each executed query must be logged. Should be boolean-like value.\r\n     * - TYPEORM_LOGGING_FAILED_QUERIES - indicates if logger should log failed query's error. Should be boolean-like value.\r\n     * - TYPEORM_LOGGING_ONLY_FAILED_QUERIES - indicates if only failed queries must be logged. Should be boolean-like value.\r\n     *\r\n     * TYPEORM_DRIVER_TYPE variable is required. Depend on the driver type some other variables may be required too.\r\n     */\r\n    async createAndConnect(): Promise<Connection>;\r\n\r\n    /**\r\n     * Creates connection from the given connection options and registers it in the manager.\r\n     */\r\n    async createAndConnect(options: ConnectionOptions): Promise<Connection>;\r\n\r\n    /**\r\n     * Creates connection with the given connection name from the ormconfig.json file and registers it in the manager.\r\n     * Optionally you can specify a path to custom ormconfig.json file.\r\n     */\r\n    async createAndConnect(connectionNameFromConfig: string, ormConfigPath?: string): Promise<Connection>;\r\n\r\n    /**\r\n     * Creates connection and and registers it in the manager.\r\n     */\r\n    async createAndConnect(optionsOrConnectionNameFromConfig?: ConnectionOptions|string, ormConfigPath?: string): Promise<Connection> {\r\n\r\n        // if connection options are given, then create connection from them\r\n        if (optionsOrConnectionNameFromConfig && optionsOrConnectionNameFromConfig instanceof Object)\r\n            return this.createAndConnectByConnectionOptions(optionsOrConnectionNameFromConfig as ConnectionOptions);\r\n\r\n        // if connection name is specified then explicitly try to load connection options from it\r\n        if (typeof optionsOrConnectionNameFromConfig === \"string\")\r\n            return this.createFromConfigAndConnect(optionsOrConnectionNameFromConfig || \"default\", ormConfigPath);\r\n\r\n        // if nothing is specified then try to silently load config from ormconfig.json\r\n        if (this.hasDefaultConfigurationInConfigurationFile())\r\n            return this.createFromConfigAndConnect(\"default\");\r\n\r\n        // if driver type is set in environment variables then try to create connection from env variables\r\n        if (this.hasDefaultConfigurationInEnvironmentVariables())\r\n            return this.createFromEnvAndConnect();\r\n\r\n        throw new CannotDetermineConnectionOptionsError();\r\n    }\r\n\r\n    /**\r\n     * Creates new connections and registers them in the manager.\r\n     *\r\n     * If array of connection options were not specified, then it will try to create them automatically\r\n     * from ormconfig.json. You can also specify path to your custom ormconfig.json file.\r\n     *\r\n     * In the case if options were not specified, and ormconfig.json file also wasn't found,\r\n     * it will try to create connection from environment variables.\r\n     * There are several environment variables you can set:\r\n     *\r\n     * - TYPEORM_DRIVER_TYPE - driver type. Can be \"mysql\", \"postgres\", \"mariadb\", \"sqlite\", \"oracle\" or \"mssql\".\r\n     * - TYPEORM_URL - database connection url. Should be a string.\r\n     * - TYPEORM_HOST - database host. Should be a string.\r\n     * - TYPEORM_PORT - database access port. Should be a number.\r\n     * - TYPEORM_USERNAME - database username. Should be a string.\r\n     * - TYPEORM_PASSWORD - database user's password. Should be a string.\r\n     * - TYPEORM_SID - database's SID. Used only for oracle databases. Should be a string.\r\n     * - TYPEORM_STORAGE - database's storage url. Used only for sqlite databases. Should be a string.\r\n     * - TYPEORM_USE_POOL - indicates if connection pooling should be enabled. By default its enabled. Should be boolean-like value.\r\n     * - TYPEORM_DRIVER_EXTRA - extra options to be passed to the driver. Should be a serialized json string of options.\r\n     * - TYPEORM_AUTO_SCHEMA_SYNC - indicates if automatic schema synchronization will be performed on each application run. Should be boolean-like value.\r\n     * - TYPEORM_ENTITIES - list of directories containing entities to load. Should be string - directory names (can be patterns) split by a comma.\r\n     * - TYPEORM_SUBSCRIBERS - list of directories containing subscribers to load. Should be string - directory names (can be patterns) split by a comma.\r\n     * - TYPEORM_ENTITY_SCHEMAS - list of directories containing entity schemas to load. Should be string - directory names (can be patterns) split by a comma.\r\n     * - TYPEORM_NAMING_STRATEGIES - list of directories containing custom naming strategies to load. Should be string - directory names (can be patterns) split by a comma.\r\n     * - TYPEORM_LOGGING_QUERIES - indicates if each executed query must be logged. Should be boolean-like value.\r\n     * - TYPEORM_LOGGING_FAILED_QUERIES - indicates if logger should log failed query's error. Should be boolean-like value.\r\n     * - TYPEORM_LOGGING_ONLY_FAILED_QUERIES - indicates if only failed queries must be logged. Should be boolean-like value.\r\n     *\r\n     * TYPEORM_DRIVER_TYPE variable is required. Depend on the driver type some other variables may be required too.\r\n     */\r\n    async createAndConnectToAll(): Promise<Connection[]>;\r\n\r\n    /**\r\n     * Creates connections from the given connection options and registers them in the manager.\r\n     */\r\n    async createAndConnectToAll(options?: ConnectionOptions[]): Promise<Connection[]>;\r\n\r\n    /**\r\n     * Creates connections from the ormconfig.json file.\r\n     * Optionally you can specify a path to custom ormconfig.json file.\r\n     */\r\n    async createAndConnectToAll(ormConfigPath?: string): Promise<Connection[]>;\r\n\r\n    /**\r\n     * Creates connections and and registers them in the manager.\r\n     */\r\n    async createAndConnectToAll(optionsOrOrmConfigFilePath?: ConnectionOptions[]|string): Promise<Connection[]> {\r\n\r\n        // if connection options are given, then create connection from them\r\n        if (optionsOrOrmConfigFilePath && optionsOrOrmConfigFilePath instanceof Array)\r\n            return Promise.all(optionsOrOrmConfigFilePath.map(options => {\r\n                return this.createAndConnectByConnectionOptions(options as ConnectionOptions);\r\n            }));\r\n\r\n        // if connection name is specified then explicitly try to load connection options from it\r\n        if (typeof optionsOrOrmConfigFilePath === \"string\")\r\n            return this.createFromConfigAndConnectToAll(optionsOrOrmConfigFilePath as string);\r\n\r\n        // if nothing is specified then try to silently load config from ormconfig.json\r\n        if (this.hasOrmConfigurationFile())\r\n            return this.createFromConfigAndConnectToAll();\r\n\r\n        // if driver type is set in environment variables then try to create connection from env variables\r\n        if (this.hasDefaultConfigurationInEnvironmentVariables())\r\n            return [await this.createFromEnvAndConnect()];\r\n\r\n        throw new CannotDetermineConnectionOptionsError();\r\n    }\r\n\r\n    // -------------------------------------------------------------------------\r\n    // Protected Methods\r\n    // -------------------------------------------------------------------------\r\n\r\n    /**\r\n     * Checks if ormconfig.json exists.\r\n     */\r\n    protected hasOrmConfigurationFile(): boolean {\r\n        const path = PlatformTools.load(\"app-root-path\").path + \"/ormconfig.json\";\r\n        if (!PlatformTools.fileExist(path))\r\n            return false;\r\n\r\n        const configuration: ConnectionOptions[]|ConnectionOptions = PlatformTools.load(path);\r\n        if (configuration instanceof Array) {\r\n            return configuration\r\n                    .filter(options => !options.environment || options.environment === PlatformTools.getEnvVariable(\"NODE_ENV\"))\r\n                    .length > 0;\r\n\r\n        } else if (configuration instanceof Object) {\r\n            if (configuration.environment && configuration.environment !== PlatformTools.getEnvVariable(\"NODE_ENV\"))\r\n                return false;\r\n\r\n            return Object.keys(configuration).length > 0;\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Checks if there is a default connection in the ormconfig.json file.\r\n     */\r\n    protected hasDefaultConfigurationInConfigurationFile(): boolean {\r\n        const path = PlatformTools.load(\"app-root-path\").path + \"/ormconfig.json\";\r\n        if (!PlatformTools.fileExist(path))\r\n            return false;\r\n\r\n        const configuration: ConnectionOptions[]|ConnectionOptions = PlatformTools.load(path);\r\n        if (configuration instanceof Array) {\r\n            return !!configuration\r\n                .filter(options => !options.environment || options.environment === PlatformTools.getEnvVariable(\"NODE_ENV\"))\r\n                .find(config => !!config.name || config.name === \"default\");\r\n\r\n        } else if (configuration instanceof Object) {\r\n            if (!configuration.name ||\r\n                configuration.name !== \"default\")\r\n                return false;\r\n\r\n            if (configuration.environment && configuration.environment !== PlatformTools.getEnvVariable(\"NODE_ENV\"))\r\n                return false;\r\n\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Checks if environment variables contains connection options.\r\n     */\r\n    protected hasDefaultConfigurationInEnvironmentVariables(): boolean {\r\n        return !!PlatformTools.getEnvVariable(\"TYPEORM_DRIVER_TYPE\");\r\n    }\r\n\r\n    /**\r\n     * Allows to quickly create a connection based on the environment variable values.\r\n     */\r\n    protected async createFromEnvAndConnect(): Promise<Connection> {\r\n        return this.createAndConnectByConnectionOptions({\r\n            driver: {\r\n                type: PlatformTools.getEnvVariable(\"TYPEORM_DRIVER_TYPE\"),\r\n                url: PlatformTools.getEnvVariable(\"TYPEORM_URL\"),\r\n                host: PlatformTools.getEnvVariable(\"TYPEORM_HOST\"),\r\n                port: PlatformTools.getEnvVariable(\"TYPEORM_PORT\"),\r\n                username: PlatformTools.getEnvVariable(\"TYPEORM_USERNAME\"),\r\n                password: PlatformTools.getEnvVariable(\"TYPEORM_PASSWORD\"),\r\n                database: PlatformTools.getEnvVariable(\"TYPEORM_DATABASE\"),\r\n                sid: PlatformTools.getEnvVariable(\"TYPEORM_SID\"),\r\n                storage: PlatformTools.getEnvVariable(\"TYPEORM_STORAGE\"),\r\n                usePool: PlatformTools.getEnvVariable(\"TYPEORM_USE_POOL\") !== undefined ? OrmUtils.toBoolean(PlatformTools.getEnvVariable(\"TYPEORM_USE_POOL\")) : undefined, // special check for defined is required here\r\n                extra: PlatformTools.getEnvVariable(\"TYPEORM_DRIVER_EXTRA\") ? JSON.parse(PlatformTools.getEnvVariable(\"TYPEORM_DRIVER_EXTRA\")) : undefined\r\n            },\r\n            autoSchemaSync: OrmUtils.toBoolean(PlatformTools.getEnvVariable(\"TYPEORM_AUTO_SCHEMA_SYNC\")),\r\n            entities: PlatformTools.getEnvVariable(\"TYPEORM_ENTITIES\") ? PlatformTools.getEnvVariable(\"TYPEORM_ENTITIES\").split(\",\") : [],\r\n            subscribers: PlatformTools.getEnvVariable(\"TYPEORM_SUBSCRIBERS\") ? PlatformTools.getEnvVariable(\"TYPEORM_SUBSCRIBERS\").split(\",\") : [],\r\n            entitySchemas: PlatformTools.getEnvVariable(\"TYPEORM_ENTITY_SCHEMAS\") ? PlatformTools.getEnvVariable(\"TYPEORM_ENTITY_SCHEMAS\").split(\",\") : [],\r\n            namingStrategies: PlatformTools.getEnvVariable(\"TYPEORM_NAMING_STRATEGIES\") ? PlatformTools.getEnvVariable(\"TYPEORM_NAMING_STRATEGIES\").split(\",\") : [],\r\n            usedNamingStrategy: PlatformTools.getEnvVariable(\"TYPEORM_USED_NAMING_STRATEGY\"),\r\n            logging: {\r\n                logQueries: OrmUtils.toBoolean(PlatformTools.getEnvVariable(\"TYPEORM_LOGGING_QUERIES\")),\r\n                logFailedQueryError: OrmUtils.toBoolean(PlatformTools.getEnvVariable(\"TYPEORM_LOGGING_FAILED_QUERIES\")),\r\n                logOnlyFailedQueries: OrmUtils.toBoolean(PlatformTools.getEnvVariable(\"TYPEORM_LOGGING_ONLY_FAILED_QUERIES\")),\r\n            }\r\n        });\r\n    }\r\n\r\n\r\n    /**\r\n     * Creates a new connection based on the connection options from \"ormconfig.json\"\r\n     * and registers a new connection in the manager.\r\n     * Optionally you can specify a path to the json configuration.\r\n     * If path is not given, then ormconfig.json file will be searched near node_modules directory.\r\n     */\r\n    protected async createFromConfigAndConnectToAll(path?: string): Promise<Connection[]> {\r\n        const optionsArray: ConnectionOptions[] = PlatformTools.load(path || (PlatformTools.load(\"app-root-path\").path + \"/ormconfig.json\"));\r\n        if (!optionsArray)\r\n            throw new Error(`Configuration ${path || \"ormconfig.json\"} was not found. Add connection configuration inside ormconfig.json file.`);\r\n\r\n        const promises = optionsArray\r\n            .filter(options => !options.environment || options.environment === PlatformTools.getEnvVariable(\"NODE_ENV\")) // skip connection creation if environment is set in the options, and its not equal to the value in the NODE_ENV variable\r\n            .map(options => this.createAndConnectByConnectionOptions(options));\r\n\r\n        return Promise.all(promises);\r\n    }\r\n\r\n    /**\r\n     * Creates a new connection based on the connection options from \"ormconfig.json\"\r\n     * and registers a new connection in the manager.\r\n     * Optionally you can specify a path to the json configuration.\r\n     * If path is not given, then ormconfig.json file will be searched near node_modules directory.\r\n     */\r\n    protected async createFromConfigAndConnect(connectionName: string, path?: string): Promise<Connection> {\r\n        const optionsArray: ConnectionOptions[] = PlatformTools.load(path || (PlatformTools.load(\"app-root-path\").path + \"/ormconfig.json\"));\r\n        if (!optionsArray)\r\n            throw new Error(`Configuration ${path || \"ormconfig.json\"} was not found. Add connection configuration inside ormconfig.json file.`);\r\n\r\n        const environmentLessOptions = optionsArray.filter(options => (options.name || \"default\") === connectionName);\r\n        const options = environmentLessOptions.filter(options => !options.environment || options.environment === PlatformTools.getEnvVariable(\"NODE_ENV\")); // skip connection creation if environment is set in the options, and its not equal to the value in the NODE_ENV variable\r\n\r\n        if (!options.length)\r\n            throw new Error(`Connection \"${connectionName}\" ${PlatformTools.getEnvVariable(\"NODE_ENV\") ? \"for the environment \" + PlatformTools.getEnvVariable(\"NODE_ENV\") + \" \" : \"\"}was not found in the json configuration file.` +\r\n                (environmentLessOptions.length ? ` However there are such configurations for other environments: ${environmentLessOptions.map(options => options.environment).join(\", \")}.` : \"\"));\r\n\r\n        return this.createAndConnectByConnectionOptions(options[0]);\r\n    }\r\n\r\n    /**\r\n     * Creates a new connection based on the given connection options and registers a new connection in the manager.\r\n     */\r\n    protected async createAndConnectByConnectionOptions(options: ConnectionOptions): Promise<Connection> {\r\n        const connection = this.create(options);\r\n\r\n        // connect to the database\r\n        await connection.connect();\r\n\r\n        // if option is set - drop schema once connection is done\r\n        if (options.dropSchemaOnConnection && !PlatformTools.getEnvVariable(\"SKIP_SCHEMA_CREATION\"))\r\n            await connection.dropDatabase();\r\n\r\n        // if option is set - automatically synchronize a schema\r\n        if (options.autoSchemaSync && !PlatformTools.getEnvVariable(\"SKIP_SCHEMA_CREATION\"))\r\n            await connection.syncSchema();\r\n\r\n        // if option is set - automatically synchronize a schema\r\n        if (options.autoMigrationsRun && !PlatformTools.getEnvVariable(\"SKIP_MIGRATIONS_RUN\"))\r\n            await connection.runMigrations();\r\n\r\n        return connection;\r\n    }\r\n\r\n    /**\r\n     * Splits given array of mixed strings and / or functions into two separate array of string and array of functions.\r\n     */\r\n    protected splitStringsAndClasses<T>(strAndClses: string[]|T[]): [string[], T[]] {\r\n        return [\r\n            (strAndClses as string[]).filter(str => typeof str === \"string\"),\r\n            (strAndClses as T[]).filter(cls => typeof cls !== \"string\"),\r\n        ];\r\n    }\r\n\r\n    /**\r\n     * Creates a new driver based on the given driver type and options.\r\n     */\r\n    protected createDriver(options: DriverOptions, logger: Logger): Driver {\r\n        switch (options.type) {\r\n            case \"mysql\":\r\n                return new MysqlDriver(options, logger, undefined);\r\n            case \"postgres\":\r\n                return new PostgresDriver(options, logger);\r\n            case \"mariadb\":\r\n                return new MysqlDriver(options, logger);\r\n            case \"sqlite\":\r\n                return new SqliteDriver(options, logger);\r\n            case \"oracle\":\r\n                return new OracleDriver(options, logger);\r\n            case \"mssql\":\r\n                return new SqlServerDriver(options, logger);\r\n            case \"websql\":\r\n                return new WebsqlDriver(options, logger);\r\n            case \"mongodb\":\r\n                return new MongoDriver(options, logger);\r\n            default:\r\n                throw new MissingDriverError(options.type);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Creates a new connection and registers it in the connection manager.\r\n     */\r\n    protected createConnection(name: string, driver: Driver, logger: Logger) {\r\n        const existConnection = this.connections.find(connection => connection.name === name);\r\n        if (existConnection) {\r\n            if (existConnection.isConnected)\r\n                throw new AlreadyHasActiveConnectionError(name);\r\n\r\n            this.connections.splice(this.connections.indexOf(existConnection), 1);\r\n        }\r\n\r\n        const connection = new Connection(name, driver, logger);\r\n        this.connections.push(connection);\r\n        return connection;\r\n    }\r\n\r\n}\r\n"],"sourceRoot":".."}